{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport * as L from 'leaflet';\nlet WorkshopInfoComponent = class WorkshopInfoComponent {\n  apply() {\n    this.workshopService.applyForWorkshop(sessionStorage.getItem('username'), this.workshopId).subscribe(resp => {\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if (this.applyMsg == 'Applied!') {\n          this.applied = 1;\n        }\n      });\n    });\n  }\n  alertMe() {\n    this.workshopService.addToWaitList(sessionStorage.getItem('username'), this.workshopId, sessionStorage.getItem('email')).subscribe(resp => {\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      });\n    });\n  }\n  initMap() {\n    this.map = L.map('map', {\n      center: [this.workshop.long, this.workshop.lat],\n      zoom: 18\n    });\n    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      minZoom: 3,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    });\n    const marker = L.marker([this.workshop.long, this.workshop.lat]).addTo(this.map);\n    tiles.addTo(this.map);\n  }\n  cancel() {\n    let username = sessionStorage.getItem('username');\n    let workshopId = this.workshop._id;\n    this.workshopService.cancelParticipation(username, workshopId).subscribe(resp => {\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      });\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      // })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      //   this.workshopService.get_all_workshops().subscribe((resp)=>{\n      //     this.workshops = resp as Workshop[];\n      //   }) \n      // })\n    });\n  }\n\n  constructor(route, workshopService, router) {\n    this.route = route;\n    this.workshopService = workshopService;\n    this.router = router;\n    this.liked = 0;\n    this.applied = 0;\n  }\n  ngOnInit() {\n    this.applyMsg = \"\";\n    this.workshopId = this.route.snapshot.paramMap.get('workshopId');\n    this.workshopDesc = this.route.snapshot.paramMap.get('workshopDesc');\n    this.workshopName = this.route.snapshot.paramMap.get('workshopName');\n    this.workshopFreeSpaces = +this.route.snapshot.paramMap.get('workshopFreeSpaces');\n    this.workshopStatus = +this.route.snapshot.paramMap.get('workshopStatus');\n    this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n      this.workshop = resp;\n      this.initMap();\n      this.workshopService.getGalleryPics(this.workshop._id).subscribe(resp2 => {\n        this.galleryPics = resp2;\n        this.workshopService.isApplied(sessionStorage.getItem('username'), this.workshopId).subscribe(result => {\n          this.applied = result['result'];\n          this.workshopService.isLiked(sessionStorage.getItem('username'), this.workshop._id).subscribe(resp12 => {\n            this.liked = resp12['result'];\n          });\n        });\n      });\n    });\n  }\n  beginChat() {\n    sessionStorage.setItem('usernameFrom', sessionStorage.getItem('username'));\n    sessionStorage.setItem('usernameTo', this.workshop.organizatorUsername);\n    sessionStorage.setItem('workshopId', this.workshop._id);\n    this.router.navigate(['user-chat']);\n  }\n  likeWorkshop() {\n    this.workshopService.likeWorkshop(sessionStorage.getItem('username'), this.workshop._id).subscribe(resp => {\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp2 => {\n        this.workshop = resp2;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if (resp['message'] == 'liked') {\n          this.liked = 1;\n        }\n      });\n    });\n  }\n  unlikeWorkshop() {\n    this.workshopService.unlikeWorkshop(sessionStorage.getItem('username'), this.workshop._id).subscribe(resp => {\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp2 => {\n        this.workshop = resp2;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if (resp['message'] == 'Uspeh!') {\n          this.liked = 0;\n        }\n      });\n    });\n  }\n};\nWorkshopInfoComponent = __decorate([Component({\n  selector: 'app-workshop-info',\n  templateUrl: './workshop-info.component.html',\n  styleUrls: ['./workshop-info.component.css']\n})], WorkshopInfoComponent);\nexport { WorkshopInfoComponent };","map":{"version":3,"mappings":"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","names":["Component","L","WorkshopInfoComponent","apply","workshopService","applyForWorkshop","sessionStorage","getItem","workshopId","subscribe","resp","applyMsg","getWorkshopById","workshop","workshopFreeSpaces","freeSpaces","workshopStatus","status","applied","alertMe","addToWaitList","initMap","map","center","long","lat","zoom","tiles","tileLayer","maxZoom","minZoom","attribution","marker","addTo","cancel","username","_id","cancelParticipation","constructor","route","router","ngOnInit","snapshot","paramMap","get","workshopDesc","workshopName","getGalleryPics","resp2","galleryPics","isApplied","result","isLiked","resp12","liked","beginChat","setItem","organizatorUsername","navigate","likeWorkshop","unlikeWorkshop","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\Matija Milosevic\\Downloads\\PIA\\InternetApplicationProject\\Projekat\\frontend\\src\\app\\workshop-info\\workshop-info.component.ts"],"sourcesContent":["import { AfterViewInit, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Workshop } from '../models/workshop';\nimport { WorkshopService } from '../workshop.service';\nimport * as L from 'leaflet';\n\n\n@Component({\n  selector: 'app-workshop-info',\n  templateUrl: './workshop-info.component.html',\n  styleUrls: ['./workshop-info.component.css']\n})\n\nexport class WorkshopInfoComponent implements OnInit  {\n  private map;\n  apply(){\n    this.workshopService.applyForWorkshop(sessionStorage.getItem('username'), this.workshopId).subscribe((resp)=>{\n      \n        this.applyMsg = resp['message'];\n        this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n          this.workshop = resp as Workshop;\n          this.workshopFreeSpaces = this.workshop.freeSpaces;\n          this.workshopStatus = this.workshop.status;\n          if(this.applyMsg == 'Applied!'){\n            this.applied = 1;\n          }\n        })\n       \n    })\n  }\n  alertMe(){\n    this.workshopService.addToWaitList(sessionStorage.getItem('username'), this.workshopId, sessionStorage.getItem('email')).subscribe((resp)=>{\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n        this.workshop = resp as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      })\n     \n\n    })\n  }\n  private initMap(): void {\n    this.map = L.map('map', {\n      center: [ this.workshop.long, this.workshop.lat],\n      zoom: 18\n    });\n    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      minZoom: 3,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    });\n    const marker = L.marker([this.workshop.long, this.workshop.lat]).addTo(this.map);\n    tiles.addTo(this.map);\n    \n  }\n  cancel(){\n    let username = sessionStorage.getItem('username');\n    let workshopId = this.workshop._id;\n    this.workshopService.cancelParticipation(username, workshopId).subscribe((resp)=>{\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n        this.workshop = resp as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      // })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      //   this.workshopService.get_all_workshops().subscribe((resp)=>{\n      //     this.workshops = resp as Workshop[];\n      //   }) \n      // })\n    })\n  }\n  constructor(private route : ActivatedRoute, private workshopService: WorkshopService, private router : Router) { }\n  workshopId : string;\n  workshopDesc: string;\n  workshopName: string;\n  workshop : Workshop;\n  liked : number | null = 0;\n  applied : number |null = 0;\n  workshopFreeSpaces : number;\n  workshopStatus : number;\n  galleryPics : string[]\n  applyMsg : string\n  ngOnInit(): void {\n    this.applyMsg = \"\"\n    this.workshopId = this.route.snapshot.paramMap.get('workshopId');\n    this.workshopDesc = this.route.snapshot.paramMap.get('workshopDesc');\n    this.workshopName = this.route.snapshot.paramMap.get('workshopName');\n    this.workshopFreeSpaces = +this.route.snapshot.paramMap.get('workshopFreeSpaces');\n    this.workshopStatus = +this.route.snapshot.paramMap.get('workshopStatus');\n    this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n      this.workshop = resp as Workshop;\n      this.initMap()\n      this.workshopService.getGalleryPics(this.workshop._id).subscribe((resp2)=>{\n        this.galleryPics = resp2 as string[]\n        this.workshopService.isApplied(sessionStorage.getItem('username'),this.workshopId).subscribe((result)=>{\n          this.applied = result['result']\n          this.workshopService.isLiked(sessionStorage.getItem('username'), this.workshop._id).subscribe((resp12)=>{\n            this.liked = resp12['result'];\n          })\n        })\n      })\n    })\n  }\n  beginChat(){\n    sessionStorage.setItem('usernameFrom' , sessionStorage.getItem('username'));\n    sessionStorage.setItem('usernameTo', this.workshop.organizatorUsername);\n    sessionStorage.setItem('workshopId', this.workshop._id);\n    this.router.navigate(['user-chat']);\n  }\n  likeWorkshop(){\n    this.workshopService.likeWorkshop(sessionStorage.getItem('username'), this.workshop._id).subscribe((resp)=>{\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp2)=>{\n        this.workshop = resp2 as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if(resp['message'] == 'liked'){\n          this.liked = 1;\n        }\n      })\n    })\n  }\n  unlikeWorkshop(){\n    this.workshopService.unlikeWorkshop(sessionStorage.getItem('username'),this.workshop._id).subscribe((resp)=>{\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp2)=>{\n        this.workshop = resp2 as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if(resp['message'] == 'Uspeh!'){\n          this.liked = 0;\n        }\n      })\n    })\n  }\n  \n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}