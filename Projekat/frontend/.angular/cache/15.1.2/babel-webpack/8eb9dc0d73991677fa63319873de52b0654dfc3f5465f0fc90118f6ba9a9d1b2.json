{"ast":null,"code":"import * as L from 'leaflet';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../workshop.service\";\nimport * as i3 from \"@angular/common\";\nfunction WorkshopInfoComponent_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵelement(2, \"img\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const picture_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"http://localhost:4000/\", picture_r4, \"\", i0.ɵɵsanitizeUrl);\n  }\n}\nfunction WorkshopInfoComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function WorkshopInfoComponent_div_17_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.apply());\n    });\n    i0.ɵɵtext(2, \"Apply\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction WorkshopInfoComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function WorkshopInfoComponent_div_19_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.alertMe());\n    });\n    i0.ɵɵtext(2, \"Alert me when its free\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction WorkshopInfoComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\", 10);\n    i0.ɵɵtext(2, \"Applied!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function WorkshopInfoComponent_div_21_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.cancel());\n    });\n    i0.ɵɵtext(4, \"Cancel\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class WorkshopInfoComponent {\n  apply() {\n    this.workshopService.applyForWorkshop(sessionStorage.getItem('username'), this.workshopId).subscribe(resp => {\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        if (this.applyMsg == 'Applied!') {\n          this.applied = 1;\n        }\n      });\n    });\n  }\n  alertMe() {\n    this.workshopService.addToWaitList(sessionStorage.getItem('username'), this.workshopId, sessionStorage.getItem('email')).subscribe(resp => {\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      });\n    });\n  }\n  initMap() {\n    this.map = L.map('map', {\n      center: [this.workshop.long, this.workshop.lat],\n      zoom: 18\n    });\n    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      minZoom: 3,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    });\n    const marker = L.marker([this.workshop.long, this.workshop.lat]).addTo(this.map);\n    tiles.addTo(this.map);\n  }\n  cancel() {\n    let username = sessionStorage.getItem('username');\n    let workshopId = this.workshop._id;\n    this.workshopService.cancelParticipation(username, workshopId).subscribe(resp => {\n      this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n        this.workshop = resp;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      });\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      // })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      //   this.workshopService.get_all_workshops().subscribe((resp)=>{\n      //     this.workshops = resp as Workshop[];\n      //   }) \n      // })\n    });\n  }\n\n  constructor(route, workshopService) {\n    this.route = route;\n    this.workshopService = workshopService;\n    this.applied = 0;\n  }\n  ngOnInit() {\n    this.applyMsg = \"\";\n    this.workshopId = this.route.snapshot.paramMap.get('workshopId');\n    this.workshopDesc = this.route.snapshot.paramMap.get('workshopDesc');\n    this.workshopName = this.route.snapshot.paramMap.get('workshopName');\n    this.workshopFreeSpaces = +this.route.snapshot.paramMap.get('workshopFreeSpaces');\n    this.workshopStatus = +this.route.snapshot.paramMap.get('workshopStatus');\n    this.workshopService.getWorkshopById(this.workshopId).subscribe(resp => {\n      this.workshop = resp;\n      this.initMap();\n      this.workshopService.getGalleryPics(this.workshop._id).subscribe(resp2 => {\n        this.galleryPics = resp2;\n        this.workshopService.isApplied(sessionStorage.getItem('username'), this.workshopId).subscribe(result => {\n          this.applied = result['result'];\n        });\n      });\n    });\n  }\n}\nWorkshopInfoComponent.ɵfac = function WorkshopInfoComponent_Factory(t) {\n  return new (t || WorkshopInfoComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.WorkshopService));\n};\nWorkshopInfoComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: WorkshopInfoComponent,\n  selectors: [[\"app-workshop-info\"]],\n  decls: 27,\n  vars: 7,\n  consts: [[\"rel\", \"stylesheet\", \"href\", \"https://unpkg.com/leaflet@1.9.3/dist/leaflet.css\", \"integrity\", \"sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=\", \"crossorigin\", \"\"], [\"name\", \"pictures\"], [4, \"ngFor\", \"ngForOf\"], [1, \"map-container\"], [1, \"map-frame\"], [\"id\", \"map\"], [4, \"ngIf\"], [\"href\", \"/user\"], [\"onerror\", \"this.src=\\\"http://localhost:4000/workshop.webp\\\"\", \"width\", \"50\", \"height\", \"50\", 3, \"src\"], [3, \"click\"], [2, \"color\", \"green\"]],\n  template: function WorkshopInfoComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"link\", 0);\n      i0.ɵɵelementStart(1, \"h1\");\n      i0.ɵɵtext(2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"h2\");\n      i0.ɵɵtext(4, \"Description:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"p\");\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"h2\");\n      i0.ɵɵtext(8, \"Gallery:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"table\", 1);\n      i0.ɵɵtemplate(10, WorkshopInfoComponent_tr_10_Template, 3, 1, \"tr\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"h2\");\n      i0.ɵɵtext(12, \"Map:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"div\", 3)(14, \"div\", 4);\n      i0.ɵɵelement(15, \"div\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(16, \"br\");\n      i0.ɵɵtemplate(17, WorkshopInfoComponent_div_17_Template, 3, 0, \"div\", 6);\n      i0.ɵɵelement(18, \"br\");\n      i0.ɵɵtemplate(19, WorkshopInfoComponent_div_19_Template, 3, 0, \"div\", 6);\n      i0.ɵɵelement(20, \"br\");\n      i0.ɵɵtemplate(21, WorkshopInfoComponent_div_21_Template, 5, 0, \"div\", 6);\n      i0.ɵɵelement(22, \"br\");\n      i0.ɵɵtext(23);\n      i0.ɵɵelement(24, \"br\");\n      i0.ɵɵelementStart(25, \"a\", 7);\n      i0.ɵɵtext(26, \"Back\");\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.workshopName);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(ctx.workshopDesc);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.galleryPics);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.workshopFreeSpaces > 0 && ctx.workshopStatus == 0 && ctx.applied == 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.workshopFreeSpaces == 0 || ctx.workshopStatus == 1 && ctx.applied == 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.applied == 1);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" \", ctx.applyMsg, \"\\n\");\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf],\n  styles: [\".map-container[_ngcontent-%COMP%] {\\r\\n    height: 300px;\\r\\n    width: 300px;\\r\\n   \\r\\n  }\\r\\n  \\r\\n  .map-frame[_ngcontent-%COMP%] {\\r\\n    border: 2px solid black;\\r\\n    height: 100%;\\r\\n  }\\r\\n  \\r\\n  #map[_ngcontent-%COMP%] {\\r\\n    height: 100%;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvd29ya3Nob3AtaW5mby93b3Jrc2hvcC1pbmZvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2IsWUFBWTs7RUFFZDs7RUFFQTtJQUNFLHVCQUF1QjtJQUN2QixZQUFZO0VBQ2Q7O0VBRUE7SUFDRSxZQUFZO0VBQ2QiLCJzb3VyY2VzQ29udGVudCI6WyIubWFwLWNvbnRhaW5lciB7XHJcbiAgICBoZWlnaHQ6IDMwMHB4O1xyXG4gICAgd2lkdGg6IDMwMHB4O1xyXG4gICBcclxuICB9XHJcbiAgXHJcbiAgLm1hcC1mcmFtZSB7XHJcbiAgICBib3JkZXI6IDJweCBzb2xpZCBibGFjaztcclxuICAgIGhlaWdodDogMTAwJTtcclxuICB9XHJcbiAgXHJcbiAgI21hcCB7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgfVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["L","i0","WorkshopInfoComponent","apply","workshopService","applyForWorkshop","sessionStorage","getItem","workshopId","subscribe","resp","applyMsg","getWorkshopById","workshop","workshopFreeSpaces","freeSpaces","workshopStatus","status","applied","alertMe","addToWaitList","initMap","map","center","long","lat","zoom","tiles","tileLayer","maxZoom","minZoom","attribution","marker","addTo","cancel","username","_id","cancelParticipation","constructor","route","ngOnInit","snapshot","paramMap","get","workshopDesc","workshopName","getGalleryPics","resp2","galleryPics","isApplied","result","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Matija Milosevic\\Downloads\\PIA\\InternetApplicationProject\\Projekat\\frontend\\src\\app\\workshop-info\\workshop-info.component.ts","C:\\Users\\Matija Milosevic\\Downloads\\PIA\\InternetApplicationProject\\Projekat\\frontend\\src\\app\\workshop-info\\workshop-info.component.html"],"sourcesContent":["import { AfterViewInit, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Workshop } from '../models/workshop';\nimport { WorkshopService } from '../workshop.service';\nimport * as L from 'leaflet';\n\n\n@Component({\n  selector: 'app-workshop-info',\n  templateUrl: './workshop-info.component.html',\n  styleUrls: ['./workshop-info.component.css']\n})\n\nexport class WorkshopInfoComponent implements OnInit  {\n  private map;\n  apply(){\n    this.workshopService.applyForWorkshop(sessionStorage.getItem('username'), this.workshopId).subscribe((resp)=>{\n      \n        this.applyMsg = resp['message'];\n        this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n          this.workshop = resp as Workshop;\n          this.workshopFreeSpaces = this.workshop.freeSpaces;\n          this.workshopStatus = this.workshop.status;\n          if(this.applyMsg == 'Applied!'){\n            this.applied = 1;\n          }\n        })\n       \n    })\n  }\n  alertMe(){\n    this.workshopService.addToWaitList(sessionStorage.getItem('username'), this.workshopId, sessionStorage.getItem('email')).subscribe((resp)=>{\n      this.applyMsg = resp['message'];\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n        this.workshop = resp as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      })\n     \n\n    })\n  }\n  private initMap(): void {\n    this.map = L.map('map', {\n      center: [ this.workshop.long, this.workshop.lat],\n      zoom: 18\n    });\n    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      minZoom: 3,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    });\n    const marker = L.marker([this.workshop.long, this.workshop.lat]).addTo(this.map);\n    tiles.addTo(this.map);\n    \n  }\n  cancel(){\n    let username = sessionStorage.getItem('username');\n    let workshopId = this.workshop._id;\n    this.workshopService.cancelParticipation(username, workshopId).subscribe((resp)=>{\n      this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n        this.workshop = resp as Workshop;\n        this.workshopFreeSpaces = this.workshop.freeSpaces;\n        this.workshopStatus = this.workshop.status;\n        this.applied = 0;\n      })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      // })\n      // this.workshopService.getWorkshopsByParticipation(this.username,0).subscribe((resp)=>{\n      //   this.appliedWorkshops = resp as Workshop[];\n      //   this.workshopService.get_all_workshops().subscribe((resp)=>{\n      //     this.workshops = resp as Workshop[];\n      //   }) \n      // })\n    })\n  }\n  constructor(private route : ActivatedRoute, private workshopService: WorkshopService) { }\n  workshopId : string;\n  workshopDesc: string;\n  workshopName: string;\n  workshop : Workshop;\n  applied : number |null = 0;\n  workshopFreeSpaces : number;\n  workshopStatus : number;\n  galleryPics : string[]\n  applyMsg : string\n  ngOnInit(): void {\n    this.applyMsg = \"\"\n    this.workshopId = this.route.snapshot.paramMap.get('workshopId');\n    this.workshopDesc = this.route.snapshot.paramMap.get('workshopDesc');\n    this.workshopName = this.route.snapshot.paramMap.get('workshopName');\n    this.workshopFreeSpaces = +this.route.snapshot.paramMap.get('workshopFreeSpaces');\n    this.workshopStatus = +this.route.snapshot.paramMap.get('workshopStatus');\n    this.workshopService.getWorkshopById(this.workshopId).subscribe((resp)=>{\n      this.workshop = resp as Workshop;\n      this.initMap()\n      this.workshopService.getGalleryPics(this.workshop._id).subscribe((resp2)=>{\n        this.galleryPics = resp2 as string[]\n        this.workshopService.isApplied(sessionStorage.getItem('username'),this.workshopId).subscribe((result)=>{\n          this.applied = result['result']\n        })\n      })\n    })\n  }\n  \n  \n\n\n}\n","<link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.3/dist/leaflet.css\"\nintegrity=\"sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=\"\ncrossorigin=\"\"/>\n <!-- Make sure you put this AFTER Leaflet's CSS -->\n <script src=\"https://unpkg.com/leaflet@1.9.3/dist/leaflet.js\"\n     integrity=\"sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=\"\n     crossorigin=\"\"></script>\n<h1>{{workshopName}}</h1>\n<h2>Description:</h2>\n<p>{{workshopDesc}}</p>\n<h2>Gallery:</h2>\n<table name=\"pictures\">\n  <tr *ngFor=\"let picture of galleryPics\">\n    <td>\n      <img src=\"http://localhost:4000/{{picture}}\" onerror='this.src=\"http://localhost:4000/workshop.webp\"' width=\"50\" height=\"50\">\n    </td>\n    \n  </tr>\n</table>\n<h2>Map:</h2>\n<div class=\"map-container\">\n    <div class=\"map-frame\">\n      <div id=\"map\"></div>\n    </div>\n  </div>\n  <br>\n  <div *ngIf=\"workshopFreeSpaces > 0 && workshopStatus == 0 && applied == 0\">\n    <button (click)=\"apply()\">Apply</button>\n  </div>\n  <br>\n  <div *ngIf=\"workshopFreeSpaces == 0 || workshopStatus == 1 && applied == 0\">\n    <button (click)=\"alertMe()\">Alert me when its free</button>\n  </div>\n  <br>\n  <div *ngIf=\"applied == 1\">\n    <p style=\"color: green;\">Applied!</p>\n    <button (click)=\"cancel()\">Cancel</button>\n  </div>\n  <br>\n\n{{applyMsg}}\n<br>\n<a href=\"/user\">Back</a>\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}